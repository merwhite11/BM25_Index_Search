If the moon still had a magnetic field how long would have been possible to keep an atmosphere?

Let's assume the Moon had a considerable magnetic field to prevent the atmosphere dispersion caused by solar wind. Given the low gravity of the Moon, how many years would pass before all the gases (of an Earth like atmosphere) would escape its body? Would its gravity be sufficient to trap heavier gases like CO2?