How to calculate the limiting magnitude of Hubble?

I've found various sources on the web stating that the limiting apparent magnitude of the Hubble Space Telescope is about 31 or 31.5. Wikipedia lists that here and it has a cite to a pdf about it.
What I want to know is how is that calculated?
I'm aware of two methods found at the bottom of a table here, but they seems to be general calculations for ground-based telescopes, because if I plug in Hubble's numbers, I get something around 21. The difference between an apparent magnitude of 21 and 31 is actually something like ten thousands times (in terms of brightness).
Also, one key factor missing in their formulas is exposure time. I'm pretty sure the limiting magnitude has something to do with exposure time. Hubble Ultra Deep Field, for example, had an exposure time of about 1 million seconds.
So to sum up, how would we calculate the limiting magnitude of a space-based telescope, in visible light?