What triggers solar flares?

The sun is a big ball of hot plasma which contains free electrons. However, how does the absence of metallic elements in the sun generate the magnetic field to orchestrate these free electrons to display such beautiful solar phenomenon?