What are the main differences between solar flares and coronal mass ejections?

Specifically, what causes them, what sort of damage can they cause, and what are the differences in their composition?