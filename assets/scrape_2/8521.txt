How do astronomers choose their research topic?

Astronomers don't face much of an ordinary jobs market in their "trade". What does the process look like from choosing a topic for the PhD to doing research in a specific topic?
Let's say that you're very interested in exoplanets, would you as a new PhD on the topic be offered and accept a position in a project which does galaxies instead? And could you choose weather to do the physical theory or the observations or coding simulations? Can you pick and choose?