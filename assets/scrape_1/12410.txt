What parameters determine whether galaxies colliding will result in a merger or a hit and run?

Colliding galaxies sometimes merge and sometimes pass through each other. Either way, there are huge changes as a result. What are the parameters that matter in determining whether a collision will result in a merger or a hit and run, or something in between? What will be the result of the Milky Way-Andromeda collision?
Thinking about this some more, I suppose the most clearcut distinctions for the result would be whether the two supermassive black holes end up unbound, bound, or merged. Would it be possible for the bulk of the two galaxies to merge, but one or two of the SMBH's go on their merry way?