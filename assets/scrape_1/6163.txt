Why do some celestial bodies have atmospheres, and not others?

Question is rather self-explanatory. An answer touching upon how/why atmospheres are formed in the first place would be ideal as well. An example of such astral bodies would be The Earth and it's moon. Earth has an atmosphere, while the moon does not. Why is that so?